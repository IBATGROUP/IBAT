import{b as qn,g as Qn,j as vo}from"static/js/chunk-ASCISE7Y.min.js";import{a as Je,b as Rn,c as ko}from"static/js/chunk-SAW654Y4.min.js";import{a as on}from"static/js/chunk-LSFONDAL.min.js";import{a as go,c as po}from"static/js/chunk-65T5Z2YY.min.js";import{$ as Lt,$a as se,Aa as Fn,Ba as Gn,Bd as le,Be as To,Cc as mo,Cd as Xt,Da as Nt,Db as Le,Dc as uo,Dd as lt,E as hn,Eb as no,Ec as qt,Ed as H,F as xt,Fd as bo,Ga as Hn,Gb as ze,Ha as Wn,Hc as Xe,Id as Jt,Ie as Co,Ja as Yn,Jb as $t,Jd as Ce,Ka as $n,Kb as Ke,Kd as ct,Lb as oo,Nb as io,Nd as Fe,O as Et,Oa as jn,Ob as ro,Oc as Qt,P as Dn,Pb as ne,Qd as ho,Ra as Ft,Rb as ye,Rd as Zt,Sa as I,Sb as j,Sd as So,Tb as J,Ud as Ae,Wd as Ro,Xa as v,Xb as V,Y as X,Yb as so,_b as Pt,a as _e,ab as Ht,ac as it,bb as Jn,cd as Pn,d as xe,dd as fo,eb as Rt,fb as Yt,fc as Ve,fe as en,g as Ot,ge as Po,hb as N,hd as Hi,ib as qe,ic as st,jb as at,jc as lo,k as En,kb as Zn,kc as wt,kd as yo,ke as wo,lc as kt,le as tn,mb as eo,me as nn,n as ht,nb as to,o as St,oa as _n,ob as Qe,oe as mt,p as nt,pc as D,qa as At,qc as be,ra as Dt,sa as Un,ta as Vn,te as zo,u as Ln,ua as Sn,va as _t,w as Bt,wa as Ee,x as An,xa as Nn,xc as Ne,xd as Ze,ya as Ut,yd as wn,z as Mt,za as Vt,zc as co,zd as Kt}from"static/js/chunk-WXDILMFC.min.js";import{f as jt}from"static/js/chunk-4A5U2GP4.min.js";import{e as Gi}from"static/js/chunk-YHARRY32.min.js";import"static/js/chunk-ERHUJP3G.min.js";import{a as bn}from"static/js/chunk-YINCPRHN.min.js";import"static/js/chunk-32SZ2X3A.min.js";import"static/js/chunk-2BY25Q75.min.js";import{O as ao,R as S,S as Te,b as Kn,j as Xn,u as rt,v as Y}from"static/js/chunk-HRGWFZSS.min.js";import{s as T,x as C,y as Gt}from"static/js/chunk-FYAAXITJ.min.js";import{d as Wt,e as je,g as d}from"static/js/chunk-GDZRQYSV.min.js";import{A as Me,G as g,N as It,T as U,V as ae,W as s,X as b,n as vt,q as k,w as l,y as xn}from"static/js/chunk-4SZKWRVS.min.js";import"static/js/chunk-ICYT6H5B.min.js";import{a as Ue,b as ot}from"static/js/chunk-6Z77QNA7.min.js";import{a as B,b as te,e as Be,i as P,l as c}from"static/js/chunk-57DNK6NM.min.js";c();var $e=P(k());U();c();var F=P(k());U();c();var rn=50;function kn(o){return ht().collection("api-tokens").doc(o)}function Io(o){return ht().collection("api-tokens").where("user","==",o)}function Oo(o){return{label:"",token:Wi(),user:o,createdAt:xe.firestore.Timestamp.now()}}function Wi(){return`gb_api_${St()}${St()}`.replace(/\-/g,"")}c();function zn(o){return X(o).collection("saml")}function an(o,e){return zn(o).doc(e)}function Bo(o,e,t){o.set(an(e,t.key),t),o.update(X(e),{[`samlProviders.${t.key}`]:t.label})}function Mo(o,e,t){var i;let n=Object.keys((i=e.samlProviders)!=null?i:{});n.length===1&&n[0]===t&&o.update(X(e.key),{enforceSSO:!1}),o.delete(an(e.key,t)),o.update(X(e.key),B({[`samlProviders.${t}`]:xe.firestore.FieldValue.delete()},e.deprecatedDefaultSAMLProvider===t?{deprecatedDefaultSAMLProvider:xe.firestore.FieldValue.delete()}:{}))}function xo(){return{key:St(),label:"",ssoURL:"",entityID:"",certificate:"",createdAt:xe.firestore.Timestamp.now(),defaultRole:"edit"}}c();function Yi(){return ht().collection("sso")}function sn(o){return Yi().doc(o)}c();function ln(o){switch(o){case"content_publish_state_changed":return"Visibility changed";case"change_request_opened":return"Submitted for review";case"comment_mention":return"Mentioned in a comment";case"comment_posted":return"Comment posted";case"comment_reply":return"Reply to a comment";case"review_comment_posted":return"Comment on change request posted"}}function Eo(o){switch(o){case"in_app":return"App";case"email":return"Email";case"web_push":return"Browser push";case"mobile_push":return"Mobile push";case"sms":return"SMS";case"slack":return"Slack"}}c();function Lo(o){switch(o){case"admin":return"Admin";case"owner":return"My content";case"subscriber":return"Subscribed content";case"contributor":return"Participating";case"target":return"My mentions";case"original_poster":return"My comment threads";case"content_owner":return"Change request in my content";case"owner":return"My change requests"}}function Ao(o){switch(o){case"admin":return"Applies to content you administrate, but aren't the owner of.";case"owner":return"Applies to content you've created.";case"subscriber":return"Applies to content you're subscribed to.";case"contributor":return"Applies to content you've edited, customized, or discussed.";case"target":return"When you are mentioned directly";case"original_poster":return"Applies to comment threads that you started";case"content_owner":return"Applies to change requests in your content";case"owner":return"Applies to change requests you create"}}c();var Do=P(Hi()),_o=P(k());function ut(o){let e=o.filter?o.filter:()=>!0;return Qe({search:o.search||"Search users\u2026",groups:[{key:"results",commands:t=>{let n=t.query.text,i=ho.read({query:n,types:o.allowTeams?["users","teams"]:["users"],filters:{users:o.filterUsers,teams:o.filterTeams}}),{users:r=[],teams:a=[],emails:m=[]}=o.getSelection?o.getSelection():{},p=y=>{let h="objectID"in y?y.objectID:y.uid,z=r.includes(h);return{key:h,icon:({size:A})=>_o.createElement(en,{user:y,size:A}),title:y.displayName,checked:o.getSelection?z:void 0,trigger:()=>(o.onPick("user",h,z),ut(o))}},u=y=>{let h="key"in y?y.key:y.team,z=a.some(A=>A[1]===h);return{key:h,icon:d.Users,title:y.title,checked:o.getSelection?z:void 0,trigger:()=>(o.onPick("team",h,z),ut(o))}},f=y=>{let h=m.some(z=>z===y);return{key:y,icon:d.Email,title:y,checked:o.getSelection?h:void 0,trigger:()=>(o.onPick("email",y,h),ut(o))}},R=[...o.allowEmails&&(0,Do.default)(n)&&e("email",n)?[{key:"invite-email",icon:d.Email,title:`Send e-mail invitation to ${n}`,trigger:()=>(o.onPick("email",n,!1),ut(o))}]:[],...i.filter(y=>e(y.index==="users"?"user":"team",y.object.objectID)).map(y=>{if(y.index==="users")return p(y.object);if(y.index==="teams")return u(y.object);throw new Error("Invalid result type")})];if(n.length===0){let y=lt([...r.map(A=>Bt(A)),...a.map(([A,O])=>Ee(A,O))]),h=y.slice(0,r.length).filter(ot),z=y.slice(0,a.length).filter(ot);return[...R.filter(A=>!r.includes(A.key)&&!a.some(([O,ke])=>ke===A.key)),...m.map(f),...z.map(u),...h.map(p)]}return R}}]})}c();var Se=P(k());U();c();var ge=P(k());U();function Uo(o){let{pointer:e,pointerValue:t,onClose:n}=o,[i,r]=ge.useState(t.hostname||""),[a,m]=ge.useState(null),[,p]=T(C),u=async()=>{try{await Gn(i,e),e.type==="organization"?v(I(t,{type:"organization_edit_hostname",hostname:i})):v({type:"account_edit_hostname",hostname:i}),n()}catch(f){if(m(f),!f.expose)throw f}};return ge.createElement(ye,{title:"Edit GitBook subdomain",subtitle:`Pick a GitBook subdomain, all published content in this ${e.type==="organization"?"organization":"account"} will be accessible under this domain.`,onClose:n,footer:ge.createElement(l,{style:[b.directionRow,b.justifyContentEnd]},ge.createElement(S,{onPress:n,kind:"secondary",style:s.Margin.smallRight},"Close"),ge.createElement(Pt,{onPress:u,kind:"primary"},"Save"))},ge.createElement(N,{label:"Domain",placeholder:"acme",value:i,onChangeText:r,onSubmit:u,suffix:`.${_e.content.publicDomain}`,feedback:a?{type:"danger",message:Ot(a)}:{type:"none"}}),ge.createElement(l,{style:[b.directionRow,b.alignCenter,s.Margin.mediumTop]},ge.createElement(l,{style:[s.Margin.mediumRight,s.Margin.xsmallLeft]},ge.createElement(d.InfoCircle,{size:ae.ICON_M,style:[p.textMuted]})),ge.createElement(l,{style:[b.flex1]},ge.createElement(g,{style:[p.Caption,p.textMuted]},"If you change your"," ",e.type==="organization"?"organization":"account","\u2019s domain, GitBook will automatically redirect visitors from the current domain to the new one."," ",ge.createElement(Xe,{path:"organizations/organization-management"},"Learn more")))))}function cn(o){let{pointer:e,style:t}=o,[n,i]=Se.useState(null),[,r]=T(C),[a]=H([Nt(e)]);return Se.createElement(Se.Fragment,null,Se.createElement(ne,{label:"GitBook subdomain",labelDescription:a.hostname?Se.createElement(Se.Fragment,null,"Your ",e.type==="organization"?"organization":"account",' is configured to use "',Se.createElement(g,{style:r.Bold},`${a.hostname}.${_e.content.publicDomain}`),'". All published content will be accessible under this domain.'):`Pick a subdomain under ${_e.content.publicDomain} for your published spaces.`,labelSelectable:!0,style:t},Se.createElement(S,{size:"medium",kind:"secondary",onPress:()=>i("edit")},"Edit subdomain")),Se.createElement(J,null,n==="edit"?Se.createElement(Uo,{pointer:e,pointerValue:a,onClose:()=>i(null)}):null))}c();var Ge=P(k());U();function Vo(o){let{org:e,onClose:t,onCreate:n}=o,[i,r]=Ge.useState(!1),[a,m]=Ge.useState(""),p=Ae();le(I(e,{screen:"team_create"}),[e]);let u=async()=>{if(!!a)try{r(!0);let f=Nn({title:a,members:[p.uid]});await Ee(e,f.key).set(f),v({type:"team_create",team:f.key,organization:e}),n(f)}finally{r(!1)}};return Ge.createElement(ye,{title:"Create a team",subtitle:"User teams let you manage entire departments at once, by bundling them together in a group.",onClose:t,footer:Ge.createElement(l,{style:[b.directionRow,b.justifyContentEnd]},Ge.createElement(S,{kind:"secondary",onPress:t,style:s.Margin.smallRight},"Cancel"),Ge.createElement(S,{icon:i?rt:void 0,disabled:i,kind:"primary",onPress:u},"Create Team"))},Ge.createElement(N,{autoFocus:!0,label:"Name",labelDescription:"The name of your team. Keep it simple.",placeholder:"e.g. Account Team",autoCompleteType:"off",value:a,onChangeText:m,disabled:i}))}c();var et=P(k());U();function No(o){let{orgKey:e,team:t,onClose:n}=o,[i,r]=et.useState(t.title);le(I(e,{screen:"team_edit"}),[e]);let a=async()=>{i!==t.title&&(Ee(e,t.key).update({title:i}),v(I(e,{type:"team_edit_name",team:t.key}))),n()};return et.createElement(ye,{title:"Edit team",onClose:n,footer:et.createElement(l,{style:[b.directionRow,b.justifyContentEnd]},et.createElement(S,{kind:"secondary",onPress:n,style:s.Margin.smallRight},"Cancel"),et.createElement(S,{kind:"primary",onPress:a},"Save"))},et.createElement(N,{autoFocus:!0,label:"Name",labelDescription:"The name of your team. Keep it simple.",placeholder:"e.g. Account Team",autoCompleteType:"off",value:i,onChangeText:r}))}c();var Re=P(k());function Fo(o){let f=o,{orgKey:e,team:t,isDirectoryTeam:n}=f,i=Be(f,["orgKey","team","isDirectoryTeam"]),[r,a]=Re.useState(null),m=()=>{a(null)},p=Re.useMemo(()=>Qe({groups:[...n?[]:[{key:"team_actions",commands:[{key:"edit",icon:d.Edit,title:"Edit title",trigger:()=>{a("edit")}}]}],{key:"team_danger_actions",commands:[{key:"delete",icon:d.Trashcan,title:"Delete team",trigger:()=>{a("deleting")}}]}]}),[e,t.key]),u=R=>{m(),R&&Ee(e,t.key).delete(),v(I(e,{type:"team_delete",team:t.key}))};return Re.createElement(Re.Fragment,null,Re.createElement(J,null,r==="edit"?Re.createElement(No,{orgKey:e,team:t,onClose:m}):null),Re.createElement(J,null,r==="deleting"?Re.createElement(j,{kind:"danger",title:`Delete team "${t.title}"`,confirmButtonText:"Delete",onComplete:u},"Removing this team will remove any permissions associated with the team from your GitBook organization. Members of the team will not be deleted from GitBook. Are you sure?"):null),Re.createElement(Ke,B({palette:p,icon:d.MoreVertical},i)))}c();var Tn=P(k());function Go(o){let i=o,{orgKey:e,team:t}=i,n=Be(i,["orgKey","team"]);return Tn.createElement(Ke,B({palette:()=>$i(e,t),rightIcon:d.ChevronDown},n),t.members.length," ",Tn.createElement(be,{count:t.members.length,singular:"Member",plural:"Members"}))}function $i(o,e){let t=Ee(o,e.key);return ut({search:"Select members\u2026",getSelection:()=>{let[n]=lt([t]);return{users:(n==null?void 0:n.members)||[]}},onPick:(n,i,r)=>{nt(a=>{r?Vt(a,o,e.key,[i]):Ut(a,o,e.key,[i])}),v(I(o,{type:r?"team_remove_member":"team_add_member",team:e.key})),Xt.clear(t)},filterUsers:Wn(o)})}c();var oe=P(k());U();c();var re=P(k());U();function Ho(o){let{pointer:e,initialDefaultContent:t,onClose:n}=o,i=e.type==="organization"?{organization:e.organization}:{user:e.user},r=e.type==="organization"?X(e.organization):Bt(e.user),{spaces:a,collections:m}=Zt(),[,p]=T(C),u=bn(a.filter(O=>hn(O,i)&&(O.visibility==="public"||O.visibility==="unlisted"))),f=bn(m.filter(O=>hn(O,i)&&(O.visibility==="public"||O.visibility==="unlisted"))),[R,y]=re.useState(t||(u.length>0?{type:"space",space:u[0].key}:null)||(f.length>0?{type:"collection",collection:f[0].key}:null)),h=async O=>{await r.update({defaultContent:O||xe.firestore.FieldValue.delete()}),e.type==="organization"?v(I(e.organization,{type:"organization_edit_default_content",contentType:O?O.type:null})):v({type:"account_edit_default_content",contentType:O?O.type:null}),n()},z=async()=>{await h(null)},A=async()=>{await h(R)};return re.createElement(ye,{title:"Edit default content",subtitle:`Choose the content you'd like users to see when they visit your ${e.type==="organization"?"organization":"account"}'s public GitBook domain.`,onClose:n,footer:re.createElement(l,{style:[b.directionRow,b.justifySpaceBetween]},re.createElement(l,null,t?re.createElement(Pt,{onPress:z,style:s.Margin.smallRight},"Reset"):null),re.createElement(l,{style:[b.directionRow]},re.createElement(S,{onPress:n,kind:"secondary",style:s.Margin.smallRight},"Close"),re.createElement(Pt,{onPress:A,kind:"primary"},"Save")))},re.createElement(l,{style:[b.directionRow,b.alignCenter,s.Margin.mediumBottom]},re.createElement(l,{style:[s.Margin.mediumRight,s.Margin.xsmallLeft]},re.createElement(d.InfoCircle,{size:ae.ICON_M,style:[p.textMuted]})),re.createElement(l,{style:[b.flex1]},re.createElement(g,{style:[p.Caption,p.textMuted]},"Only spaces and collections that have been published publicly can be selected."))),R?re.createElement(zo,{value:R,spaces:u,collections:f,onValueChange:y,paletteTitle:"Choose default content\u2026"}):re.createElement(Te,{kind:"warning",title:"No compatible spaces.",details:"Publish a space or a collection and come back."}))}function mn(o){var f;let{pointer:e,style:t}=o,[n,i]=oe.useState(null),[,r]=T(C),[a]=H([Nt(e)]),m=a.defaultContent?((f=a.defaultContent)==null?void 0:f.type)==="space"?Et(a.defaultContent.space):xt(a.defaultContent.collection):null,[p]=H([m]),u=m&&Dn(m);return oe.createElement(oe.Fragment,null,oe.createElement(ne,{label:"Default Content",labelDescription:oe.createElement(oe.Fragment,null,"Users visiting your"," ",e.type==="organization"?"organization":"account","'s public GitBook domain will"," ",p?oe.createElement(oe.Fragment,null,"be taken to the ",u?"space":"collection"," ",oe.createElement(g,{style:r.Bold},p.title),"."):oe.createElement(oe.Fragment,null,oe.createElement(g,{style:r.Bold},"be shown the first public content"),".")),labelSelectable:!0,style:t},oe.createElement(S,{size:"medium",kind:"secondary",onPress:()=>i("edit")},"Change default content")),oe.createElement(J,null,n==="edit"?oe.createElement(Ho,{pointer:e,initialDefaultContent:a.defaultContent,onClose:()=>i(null)}):null))}c();var Z=P(k());function un(o){let{target:e}=o;return Z.createElement(D,{title:"Installed Integrations",button:Z.createElement(wn,{size:"medium",kind:"secondary",icon:d.Plus,to:{current:{type:"integrations",organization:e.organization,space:void 0}}},"Install integration")},Z.createElement(Z.Suspense,{fallback:Z.createElement(Y,{size:"medium"})},Z.createElement(ji,{target:e})))}function ji(o){let{target:e}=o,[t]=H([Qn(e)]);return t.length===0?Z.createElement(Ve,null,"No integration has been installed on this",e.organization?"organization":"account",". Start by discovering our integrations."):Z.createElement(Z.unstable_SuspenseList,{revealOrder:"together"},t.map(n=>Z.createElement(qi,{key:n.key,target:e,installation:n})))}function qi(o){var i;let{target:e,installation:t}=o,[n]=H([qn(t.integration)]);return n?Z.createElement(ze,{layout:"wide",icon:je(vo,{integration:n}),title:n.title,hint:Z.createElement(Z.Fragment,null,"Installed"," ",Z.createElement(Le,{value:((i=Ln(t.edits))==null?void 0:i.updatedAt.toDate())||new Date,onlyDate:!1})," ","on ",t.spaces.length," ",Z.createElement(be,{count:t.spaces.length,singular:"space",plural:"spaces"})),buttons:[Z.createElement(wn,{icon:d.Settings,size:"medium",kind:"secondary",to:{current:{type:"integrations",organization:e.organization,space:void 0,integration:t.integration}}},"Configure")]}):null}c();var dt=P(k());U();function pe(o){let{title:e,description:t}=o,[,n]=T(C);return dt.createElement(l,{style:[s.Margin.largeBottom,s.Margin.xlargeTop]},dt.createElement(l,null,dt.createElement(g,{style:[n.Heading1,n.text]},e)),t?dt.createElement(l,{style:s.Margin.smallTop},dt.createElement(g,{style:[n.Heading3,n.Medium,n.textMid]},t)):null)}c();var dn=P(k());function Wo(o){let{user:e}=o;if(!e.hostname)return null;let t={type:"user",user:e.uid};return dn.createElement(D,{title:"Publishing",style:[s.Margin.largeBottom]},dn.createElement(cn,{pointer:t,style:s.Margin.largeBottom}),dn.createElement(mn,{pointer:t}))}c();var Cn=P(k());U();function Yo(o){let e=uo(),{navigate:t}=Ze();return e.isRisky?Cn.createElement(l,{style:[s.Margin.largeBottom]},Cn.createElement(Te,{kind:"warning",icon:d.Lock,title:"Account Verification",details:"To ensure a quality experience for our users, GitBook runs verification checks during account creation. Your account has been flagged as potentially risky and needs to be verified before you can do perform certain actions.",actions:[{label:"Verify my account",onPress:()=>{t({screen:{type:"account_verification"}})}}]})):null}c();var M=P(k());U();c();var W=P(k());U();function gt(o){let{onClose:e}=o,{sendSignInLinkToEmail:t,signInWithGitHub:n,signInWithGoogle:i,signInWithEmailAndPassword:r}=Ce(),[,a]=T(C),[m,p]=se(),[u,f]=W.useState(null),R=mo();if(!R)throw new Error("User is not authenticated");let y=qt();le("account_settings_reauthenticate",[]);let h=async O=>{p(async()=>{await(O==="github"?n():i()),e()})},z=async()=>{p(async()=>{!R.email||(await t(R.email),f("link-sent"))})},A=async O=>{p(async()=>{f(null),await r(R.email,O),e()})};return W.createElement(ye,{title:"Reauthenticate",subtitle:"You need to reauthenticate yourself to perform this sensitive action",onClose:e},m?W.createElement(Y,{size:"medium"}):W.createElement(W.Fragment,null,u===null?W.createElement(W.Fragment,null,y.includes("google.com")?W.createElement(S,{kind:"secondary",style:[s.Margin.mediumBottom],icon:d.Google,onPress:()=>h("google")},"Google"):null,y.includes("github.com")?W.createElement(S,{kind:"secondary",style:[s.Margin.mediumBottom],icon:d.GitHub,onPress:()=>h("github")},"GitHub"):null,y.includes("password")?W.createElement(S,{kind:"secondary",style:[s.Margin.mediumBottom],icon:d.Lock,onPress:()=>f("password")},"Password"):null,R.email&&R.emailVerified?W.createElement(S,{kind:"secondary",style:[s.Margin.mediumBottom],icon:d.Email,onPress:()=>z()},"Email Link"):null):null,u==="password"?W.createElement(Qi,{onClose:e,onSubmitPassword:A}):null,u==="link-sent"?W.createElement(l,null,W.createElement(g,{style:[a.Body,a.text]},"We just emailed a confirmation link to"," ",W.createElement(g,{style:a.Bold},R.email),". Click the link, and you\u2019ll be re-authenticated in.")):null))}function Qi(o){let{onClose:e,onSubmitPassword:t}=o,[n,i]=W.useState(""),r=()=>{t(n)};return W.createElement(l,null,W.createElement(l,{style:[s.Margin.mediumBottom]},W.createElement(N,{autoFocus:!0,placeholder:"Your password",autoCompleteType:"password",secureTextEntry:!0,value:n,onChangeText:i,onSubmit:r})),W.createElement(l,{style:[b.directionRow,b.justifyContentEnd]},W.createElement(S,{kind:"secondary",onPress:e,style:s.Margin.smallRight},"Cancel"),W.createElement(S,{kind:"primary",onPress:r},"Sign in")))}function $o(o){let{user:e}=o,[t,n]=M.useState(null),{deleteAccount:i,signOut:r}=Ce(),a=V(),m=u=>{u&&r(),n(null)},p=async()=>{try{await i()}catch(u){if(u.code==="auth/requires-recent-login"){n("reauthenticate");return}else throw u}n(null),a.notify({title:"Goodbye!",details:"Your account and all of its data have been successfully deleted."})};return M.createElement(M.Fragment,null,M.createElement(D,{title:"Account actions",style:[s.Margin.largeBottom]},M.createElement(l,{style:[s.Margin.largeBottom]},M.createElement(ne,{label:"Signing out",labelDescription:"You can safely sign out from the current session and choose to sign back in later."},M.createElement(S,{testID:"account.login.signOutButton",kind:"secondary",size:"medium",onPress:()=>n("logout")},"Sign out"))),M.createElement(l,null,M.createElement(ne,{label:"Account deletion",labelDescription:"By deleting your personal account, you delete all associated data. Think before acting, there's no turning back!"},M.createElement(S,{testID:"account.login.accountDeleteButton",kind:"danger",size:"medium",onPress:()=>n("delete")},"Delete account")))),M.createElement(J,null,t==="logout"?M.createElement(j,{kind:"primary",title:"Sign Out",onComplete:m},"You will be logged out of this account."):null),M.createElement(J,null,t==="delete"?M.createElement(Ki,{user:e,onDelete:p,onClose:()=>n(null)}):null),M.createElement(J,null,t==="reauthenticate"?M.createElement(gt,{onClose:()=>{n("delete")}}):null))}function Ki(o){let{user:e,onDelete:t,onClose:n}=o,[,i]=T(C),r=Zt(),a=M.useMemo(()=>Xi(e.uid,r),[e.uid,r]);return M.createElement(on,{title:"Are you sure you want to delete this account?",textToConfirm:e.email||e.displayName,confirmations:["I won't be able to log into GitBook without creating a new account",a.spaces?M.createElement(M.Fragment,null,"I understand"," ",M.createElement(g,{style:[i.Bold,i.danger]},a.spaces," ",M.createElement(be,{count:a.spaces,singular:"space",plural:"spaces"}))," ","will be deleted foverer"):null,a.collections?M.createElement(M.Fragment,null,"I understand"," ",M.createElement(g,{style:[i.Bold,i.danger]},a.collections," ",M.createElement(be,{count:a.collections,singular:"collection",plural:"collections"}))," ","will be deleted foverer"):null,a.organizations?M.createElement(M.Fragment,null,"I understand"," ",M.createElement(g,{style:[i.Bold,i.danger]},a.organizations," ",M.createElement(be,{count:a.organizations,singular:"organization",plural:"organizations"}))," ","and related content might be deleted"):null,"I understand deleted content will not be recoverable"].filter(ot),alertConfirmText:M.createElement(M.Fragment,null,"Deleting this account will delete all of its spaces and data. You cannot undo this action."),onDelete:t,onClose:n})}function Xi(o,e){let t=0,n=0,i=new Set;return Object.entries(e.permissions.organizations).forEach(([r,a])=>{a==="admin"&&i.add(r)}),e.spaces.forEach(r=>{(r.user===o||r.organization&&i.has(r.organization))&&(t+=1)}),e.collections.forEach(r=>{(r.user===o||r.organization&&i.has(r.organization))&&(n+=1)}),{spaces:t,collections:n,organizations:i.size}}c();var E=P(k());U();function qo(o){let{user:e}=o,t=()=>{let n=Oo(e.uid);kn(n.token).set(n),v({type:"account_create_apitoken"})};return E.createElement(D,{title:"API access tokens",style:[s.Margin.largeBottom],button:E.createElement(S,{kind:"secondary",size:"medium",icon:d.Plus,onPress:t},"Create new token")},E.createElement(E.Suspense,{fallback:E.createElement(Y,{size:"medium"})},E.createElement(Ji,{user:e,onCreateToken:t})))}function Ji(o){let{user:e,onCreateToken:t}=o,[,n]=T(C),[i]=H([Io(e.uid)]),r=E.useCallback(({item:m})=>E.createElement(Zi,{token:m}),[]),a=E.createElement(E.Fragment,null,"Personal access tokens are used to authenticate with the"," ",E.createElement(Xe,{path:""},"GitBook API"),".");return i.length===0?E.createElement(Ve,{icon:d.EmptyAPI,action:E.createElement(S,{kind:"secondary",size:"large",icon:d.Plus,onPress:t},"Create new token")},a):E.createElement(E.Fragment,null,E.createElement(l,{style:[s.Margin.mediumBottom]},E.createElement(g,{style:[n.Body,n.text]},a)),E.createElement(Me,{style:[vn.tokensList],data:i,renderItem:r,keyExtractor:er}))}function Zi(o){let{token:e}=o,t=kn(e.token),[n,i]=E.useState(null),r=m=>{m.length<rn&&t.update({label:m})},a=m=>{m&&(t.delete(),v({type:"account_delete_apitoken"})),i(null)};return E.createElement(E.Fragment,null,E.createElement(l,{style:vn.tokenItem},E.createElement(l,null,E.createElement(at,{placeholder:"Label",value:e.label,validate:m=>m.length>=rn?{type:"danger",message:`Label is too long, it should be less than ${rn}`}:void 0,onChangeText:r})),E.createElement(l,{style:vn.tokenItemInput},E.createElement(N,{value:e.token,readOnly:!0,copyable:!0})),E.createElement(l,null,E.createElement(S,{icon:d.X,onPress:()=>i("delete")}))),n==="delete"?E.createElement(j,{kind:"danger",title:"Are you sure you want to delete this token?",confirmButtonText:"Delete",onComplete:a},"Any applications or scripts using this token will no longer be able to access the GitBook API. You cannot undo this action."):null)}function er(o){return o.token}var vn=vt.create({buttonToolbar:{flexDirection:"row"},tokensList:{},tokenItem:{display:"flex",flexDirection:"row",marginBottom:s.medium},tokenItemInput:{paddingLeft:s.small,flex:1}});c();var $=P(k());c();var fe=P(k());U();var tr=/^\S+@\S+\.\S+/;function Qo(o){let{user:e,onClose:t}=o,{updateEmail:n}=Ce(),[i,r]=fe.useState(""),[a,m]=fe.useState(void 0),[p,u]=fe.useState(!1),[f,R]=se(),y=V();le("account_settings_email_update",[]);let h=O=>{m(null),r(O)},z=()=>{R(async()=>{if(e.email!==i){if(tr.test(i))m(void 0);else{m("The provided email does not seem valid.");return}try{await n(i,{url:`${window.location.protocol}//${window.location.host}/account`}),y.notify({kind:"success",title:"Email address updated",details:"A confirmation email has been sent to your new address, follow the link in this email to confirm.",icon:d.CheckCircle}),t()}catch(O){if(O.code==="auth/requires-recent-login")u(!0);else throw O}}})},A=!i||e.email===i||!!a||f;return fe.createElement(fe.Fragment,null,fe.createElement(ye,{title:"Update email address",subtitle:"Enter a new email address and we'll send you a confirmation email.",onClose:t,footer:fe.createElement(l,{style:[b.directionRow,b.justifyContentEnd]},fe.createElement(S,{kind:"secondary",onPress:t,style:s.Margin.smallRight},"Cancel"),fe.createElement(S,{kind:"primary",disabled:A,onPress:z},"Send confirmation email"))},f?fe.createElement(Y,{size:"medium"}):fe.createElement(N,{autoFocus:!0,label:"New email",labelDescription:`Your current email address is ${e.email}`,value:i,onChangeText:h,feedback:{type:a?"danger":"none",message:a},autoCompleteType:"email",placeholder:e.email,style:[s.Margin.mediumBottom]})),p?fe.createElement(gt,{onClose:()=>u(!1)}):null)}c();var ee=P(k());U();function Ko(o){let{onClose:e}=o,{updatePassword:t}=Ce(),[n,i]=ee.useState(""),[r,a]=ee.useState(void 0),[m,p]=ee.useState(""),[u,f]=ee.useState(void 0),[R,y]=ee.useState(!1),[h,z]=se(),A=V();le("account_settings_password_update",[]);let O=()=>{z(async()=>{if(n.length<6){a("Your password must be equal or higher to 6 characters.");return}else a(void 0);if(n!==m){f("Your confirmation must be the same as the password field.");return}else f(void 0);try{await t(n),A.notify({kind:"success",title:"Password updated",icon:d.CheckCircle,details:"Use this new password the next time you log in to GitBook"}),e()}catch(ke){if(ke.code==="auth/requires-recent-login")y(!0);else throw ke}})};return ee.createElement(ee.Fragment,null,ee.createElement(ye,{title:"Update password",subtitle:"Choose a new and secure password to protect your account.",onClose:e,footer:ee.createElement(l,{style:[b.directionRow,b.justifyContentEnd]},ee.createElement(S,{kind:"secondary",onPress:e,style:s.Margin.smallRight},"Cancel"),ee.createElement(S,{kind:"primary",disabled:h,onPress:O},"Update"))},h?ee.createElement(Y,{size:"medium"}):ee.createElement(ee.Fragment,null,ee.createElement(N,{autoFocus:!0,label:"New password",labelDescription:"Your password must be at least 6 characters long.",value:n,onChangeText:i,feedback:{type:r?"danger":"none",message:r},autoCompleteType:"password",placeholder:"Password",style:[s.Margin.mediumBottom],secureTextEntry:!0}),ee.createElement(N,{label:"Confirm your password",value:m,onChangeText:p,feedback:{type:u?"danger":"none",message:u},autoCompleteType:"password",placeholder:"Password confirmation",secureTextEntry:!0}))),R?ee.createElement(gt,{onClose:()=>y(!1)}):null)}function Xo(o){let{user:e}=o,{linkWithGitHub:t,linkWithGoogle:n,unlinkFromGitHub:i,unlinkFromGoogle:r}=Ce(),a=V(),[m,p]=$.useState(null),u=qt(),f=u.includes("google.com"),R=u.includes("github.com"),y=async z=>{(()=>{switch(z){case"google.com":return n();case"github.com":return t();case"password":case"emailLink":return;default:Ue(z)}})()&&a.notify({kind:"info",title:"Your account was successfully linked.",icon:d.CheckCircle})},h=async z=>{(()=>{switch(z){case"google.com":return r();case"github.com":return i();case"password":case"emailLink":return;default:Ue(z)}})()&&a.notify({kind:"info",title:"Your account was successfully unlinked."}),p(null)};return $.createElement($.Fragment,null,$.createElement(D,{title:"Login details",style:[s.Margin.largeBottom]},$.createElement(ne,{label:"Email",labelDescription:"Update the email used to log into your account.",style:[s.Margin.largeBottom]},$.createElement(S,{testID:"account.login.emailUpdateButton",kind:"secondary",size:"medium",onPress:()=>p("email-update")},"Update email")),$.createElement(ne,{label:"Update your password",labelDescription:"Choose or update a password to log into your account."},$.createElement(S,{testID:"account.login.passwordUpdateButton",kind:"secondary",size:"medium",onPress:()=>p("password-update")},"Update password"))),$.createElement(D,{title:"Third-party login",style:[s.Margin.largeBottom]},$.createElement(ne,{label:"Google",labelDescription:"Set up a single sign-on with Google and login with one click.",style:[s.Margin.largeBottom]},$.createElement(S,{testID:"account.login.googleLinkButton",kind:f?"danger":"secondary",size:"medium",onPress:()=>{f?p("unlink-google"):y("google.com")}},f?"Unlink account":"Link account")),$.createElement(ne,{label:"GitHub",labelDescription:"Set up a single sign-on with GitHub and login with one click."},$.createElement(S,{testID:"account.login.githubLinkButton",kind:R?"danger":"secondary",size:"medium",onPress:()=>{R?p("unlink-github"):y("github.com")}},R?"Unlink account":"Link account"))),$.createElement(J,null,m==="email-update"?$.createElement(Qo,{user:e,onClose:()=>p(null)}):null),$.createElement(J,null,m==="password-update"?$.createElement(Ko,{onClose:()=>p(null)}):null),$.createElement(J,null,m==="unlink-google"?$.createElement(j,{kind:"danger",title:"Unlink Google",confirmButtonText:"Unlink",onComplete:z=>{z&&h("google.com")}},"Are you sure that you want to unlink your Google account? You won't be able to sign-in with Google anymore."):null),$.createElement(J,null,m==="unlink-github"?$.createElement(j,{kind:"danger",title:"Unlink GitHub",confirmButtonText:"Unlink",onComplete:z=>{z&&h("github.com")}},"Are you sure that you want to unlink your GitHub account? You won't be able to sign-in with GitHub anymore."):null))}c();var ie=P(k());U();c();var gn=[{label:"Spaces and collections",notifications:["content_publish_state_changed","comment_posted"],subscriptions:["owner"]},{label:"Change requests",notifications:["change_request_opened"],subscriptions:["owner"]},{label:"Comments",notifications:["comment_reply"],subscriptions:["original_poster"]},{label:"Mentions",notifications:["comment_mention"],subscriptions:["target"]}];c();var ce=P(k());U();function Jo(o){let{preferences:e,currentChannel:t,section:n,isLast:i,toggleCategoryChannel:r,columns:a}=o,[,m]=T(ir),p=`${50/a}%`;return ce.createElement(l,null,ce.createElement(l,{key:n.label,style:[b.directionColumn,s.Padding.large,i?void 0:m.borderedSectionStyle]},ce.createElement(l,{style:[b.directionRow]},ce.createElement(pn,{header:!0},n.label),n.subscriptions.map(u=>ce.createElement(pn,{width:p,header:!0,icon:ce.createElement(nr,{content:Ao(u)})},Lo(u)))),n.notifications.map(u=>ce.createElement(l,{style:[b.directionRow],key:u},ce.createElement(pn,null,ln(u)),n.subscriptions.map(f=>ce.createElement(pn,{width:p},ce.createElement(qe,{value:or(e,u,f,t),onValueChange:R=>{r(u,f,t,R)}})))))))}function pn(o){let{header:e,icon:t,width:n,children:i}=o,[,r]=T(C);return ce.createElement(l,{style:[n?{width:n}:b.flex1,b.directionRow,b.alignCenter,s.Padding.mediumHorizontal,s.Padding.smallVertical]},ce.createElement(g,{style:[r.Label,e?r.Bold:null,r.text]},i),t)}function nr(o){let{content:e}=o,[,t]=T(C);return ce.createElement(ao,{tooltip:e},(n,i)=>ce.createElement(l,te(B({ref:i},n.events),{style:[s.Margin.mediumLeft]}),ce.createElement(d.InfoCircle,{size:ae.ICON_XS,style:t.textMuted})))}function or(o,e,t,n){let i=Ft(e,t),r=o.categories.find(m=>m.slug===i);if(!r)return!0;let a=r.channels.find(m=>m.slug===n);return a?a.enabled:!0}var ir=Gt.create({borderedSectionStyle:o=>({borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:o.colors.border.main})});var rr=gn.reduce((o,e)=>Math.max(o,e.subscriptions.length),0),In=Xn(1500,{maxWait:3*60*1e3,concurrent:!1});function Zo(){let[o,e]=ie.useState("email"),[t,n]=ie.useState(0),i=ie.useRef(null),r=V(),a=yo(),[m,p]=se();ie.useEffect(()=>{p(async()=>{await a.fetch()})},[]),ie.useEffect(()=>{!i.current&&a.categories.length&&(i.current=a)},[a.lastFetchedAt]);let u=async()=>{!i.current||(n(0),await r.notifyProgress(a.save(i.current),{title:"Saving your notification preferences"}),await r.notify({kind:"success",icon:d.Check,title:"Notification preferences saved"}))};Jn(()=>t<=0?null:"Changes that you made may not be saved.",()=>{In.flush()||In.waitCurrentExecution()},[t]);let f=async(R,y,h,z)=>{var ke;let A=Ft(R,y),O=i.current?((ke=i.current.categories.find(de=>de.slug===A))==null?void 0:ke.channels)||[]:[];i.current={categories:[...i.current?i.current.categories.filter(de=>de.slug!==A):[],{label:ln(R),slug:A,channels:[...O.filter(de=>de.slug!==h),{label:Eo(h),slug:h,enabled:z}]}]},v({type:"account_edit_notification",notificationType:R,notificationChannel:h,notificationSubscription:y,notificationEnabled:z}),In(()=>u()),n(de=>de+1)};return ie.createElement(D,{style:[s.Margin.largeBottom],titleTabs:ie.createElement(ie.Fragment,null,ie.createElement(st.Tab,{active:o==="email",onPress:()=>e("email")},"Email"),ie.createElement(st.Tab,{active:o==="in_app",onPress:()=>e("in_app")},"App")),withDefaultPadding:!1},m?ie.createElement(Y,{size:"medium"}):["email","in_app"].map(R=>ie.createElement(l,{style:R===o?{}:{display:"none"}},gn.map((y,h)=>ie.createElement(Jo,{preferences:i.current||a,columns:rr,section:y,isLast:h===gn.length-1,currentChannel:R,toggleCategoryChannel:f})))))}c();var On=P(k());function ei(o){let{user:e}=o,t=So(),n=Yn(e.uid),i=V(),r=a=>{n.set({theme:a},{merge:!0}),v({type:"account_edit_theme",theme:a}),i.notify({details:`${a[0].toUpperCase()+a.substring(1).toLowerCase()} mode enabled`,kind:"default",title:a==="dark"?"Turn down the lights!":a==="light"?"Rise and shine":"Updated theme",icon:a==="dark"?d.ThemeDark:d.ThemeLight})};return On.createElement(D,{title:"Preferences",style:[s.Margin.largeBottom]},On.createElement(ro,{label:"Interface theme",labelDescription:"Select your interface color scheme",value:t.theme,items:ar,onValueChange:r}))}var ar=[{label:"System preference",value:"default"},{label:"Light",value:"light"},{label:"Dark",value:"dark"}];c();var fn=P(k());c();var He=P(k());U();function ti(o){let{user:e}=o,t=Qt(),[,n]=T(C),i=async()=>{let r=await t({kind:"user_avatar",user:e.uid,accept:"images"},{details:"Uploading profile picture\u2026"});r&&An(te(B({},e),{photoURL:r.downloadURL}))};return He.createElement(l,{style:s.Margin.largeBottom},He.createElement(l,{style:[b.directionRow]},He.createElement(l,{style:b.directionRow},He.createElement(It,{onPress:i},He.createElement(Po,{userId:e.uid,size:ae.ICON_XL*2,squared:!0}))),He.createElement(l,{style:[b.flex1,s.Margin.mediumLeft]},He.createElement(g,{style:[n.Heading3,n.Medium,n.text]},"Profile picture"),He.createElement(g,{style:[n.Label,n.textMid]},"Use a photo or image that is 132px square or larger."))))}function ni(o){let{user:e}=o,t=V(),{updateDisplayName:n}=Ce(),i=async r=>{e.displayName!==r&&(await n(r),t.notify({kind:"success",title:"Profile updated",icon:d.CheckCircle}))};return fn.createElement(D,{title:"Your profile"},fn.createElement(ti,{user:e}),fn.createElement(at,{label:"Full Name",labelDescriptioon:"Use your full name, preferred name, or a nickname\u2026",value:e.displayName,onChangeText:i}))}c();var me=P(k());U();function oi(o){let e=po(),[t,n]=me.useState(null);return me.createElement(me.Fragment,null,t==="confirm"?me.createElement(j,{title:"Background session debugging",confirmButtonText:"Enable",onComplete:i=>{i?e(!0):n(null)}},me.createElement(l,{style:s.Margin.mediumBottom},me.createElement(g,null,"Debug logs will be recorded in the background and sent to a secured backend for analysis by our team."," ",me.createElement(Xe,{path:"resources/debugging"},"Learn more"),".")),me.createElement(l,{style:s.Margin.mediumBottom},me.createElement(g,null,"Background session debugging may slightly impact the application's performance.")),me.createElement(l,null,me.createElement(g,null,"This option can be kept enabled at all times. But you can disable it at anytime from your account settings."))):null,me.createElement(D,{title:"Troubleshooting",style:[s.Margin.largeBottom]},me.createElement(qe,{label:"Background session debugging",labelDescription:"Help the GitBook team troubleshoot issues by recording advanced logs in the background.",value:go,onValueChange:i=>{i?n("confirm"):e(!1)}})))}function ii(o){let{screen:e}=o,t=Ae(),n=Fe("MAGICBELL_NOTIFICATIONS");return le(sr(e),[e.tab]),jt(i=>{i.setTitle("Account Settings")}),F.createElement(F.Fragment,null,e.tab==="profile"?F.createElement(F.Fragment,null,F.createElement(pe,{title:"Account",description:"Manage your profile, preferences, and account settings."}),F.createElement(Yo,null),F.createElement(l,{style:[s.Margin.largeBottom]},F.createElement(ni,{user:t})),F.createElement(Xo,{user:t}),F.createElement(Wo,{user:t}),F.createElement(ei,{user:t}),F.createElement(oi,null),F.createElement($o,{user:t})):null,e.tab==="developer"?F.createElement(F.Fragment,null,F.createElement(pe,{title:"Developer Settings"}),F.createElement(qo,{user:t})):null,e.tab==="integrations"?F.createElement(F.Fragment,null,F.createElement(pe,{title:"Apps & Integrations",description:"Apps augment and extend your workflows on GitBook with integrations with other collaboration tools."}),F.createElement(un,{target:{user:t.uid}})):null,e.tab==="notification"&&n?F.createElement(F.Fragment,null,F.createElement(pe,{title:"Notification Settings",description:"Manage the types of notifications you receive."}),F.createElement(Zo,null)):null)}function sr(o){switch(o.tab){case"profile":return{screen:"account_settings_profile"};case"developer":return{screen:"account_settings_developer"};case"integrations":return{screen:"account_settings_integrations"};case"notification":return{screen:"account_settings_notification"};default:Ue(o.tab)}}c();var we=P(k());c();var pt=P(k());function ri(o){let{organization:e}=o;return e.type==="legacy-enterprise"?pt.createElement(Kt,{to:{current:{type:"org_settings",tab:"plans",organization:e.key}}}):pt.createElement(lr,{organization:e})}function lr(o){let{organization:e}=o,{data:{url:t}}=co({operationId:"getOrganizationBillingPortal",params:{organizationId:e.key},query:{}});return pt.useEffect(()=>{window.location.href=t},[]),pt.createElement(Y,{size:"large"})}c();var Ie=P(k());c();var We=P(k());U();function ai(o){let{organization:e}=o,[,t]=T(C),n=Qt(),i=async()=>{let r=await n({kind:"org_logo",organization:e.key,accept:"images"},{details:"Uploading logo\u2026"});r&&(X(e.key).update({logoURL:r.downloadURL}),v(I(e,{type:"organization_edit_logo"})))};return We.createElement(l,{style:s.Margin.largeBottom},We.createElement(l,{style:[b.directionRow]},We.createElement(l,{style:b.directionRow},We.createElement(It,{onPress:i},We.createElement(wo,{org:e,size:ae.ICON_XL*2}))),We.createElement(l,{style:[b.flex1,s.Margin.mediumLeft]},We.createElement(g,{selectable:!0,style:[t.Heading3,t.Medium,t.text]},"Organization logo"),We.createElement(g,{selectable:!0,style:[t.Label,t.textMid]},"Use a photo or image rather than text and upload an image that is 132px square or larger."))))}c();var G=P(k());U();function si(o){let{organization:e}=o,[t,n]=G.useState(null),{navigate:i}=Ze(),r=V();return G.createElement(G.Fragment,null,G.createElement(J,null,t==="delete"?G.createElement(cr,{organization:e,onDelete:()=>{n(null),v(I(e,{type:"organization_delete"})),i({screen:{type:"home",organization:void 0}}),X(e.key).delete(),r.notify({kind:"default",title:"Goodbye!",details:"Your organization and all of its data have been successfully deleted."})},onClose:()=>n(null)}):null),G.createElement(l,null,G.createElement(ne,{label:"Organization deletion",labelDescription:"By deleting this organization, you permanently delete all associated data. There's no turning back!",labelSelectable:!0},G.createElement(S,{kind:"danger",size:"medium",onPress:()=>n("delete")},"Delete organization"))))}function cr(o){let{organization:e,onDelete:t,onClose:n}=o,[,i]=T(C),[r]=H([Mt(e.key)]);return G.createElement(on,{title:"Are you sure you want to delete this?",textToConfirm:e.title,alertConfirmText:G.createElement(G.Fragment,null,"Deleting the ",G.createElement(g,{style:i.Bold},e.title)," organization will delete all of its spaces and content."),confirmations:["I won't be able to log into GitBook without creating a new account",r!=null&&r.spaces?G.createElement(G.Fragment,null,"I understand"," ",G.createElement(g,{style:[i.Bold,i.danger]},r==null?void 0:r.spaces," ",G.createElement(be,{count:r.spaces,singular:"space",plural:"spaces"}))," ","will be deleted foverer"):null,r!=null&&r.collections?G.createElement(G.Fragment,null,"I understand"," ",G.createElement(g,{style:[i.Bold,i.danger]},r.collections," ",G.createElement(be,{count:r.collections,singular:"collection",plural:"collections"}))," ","will be deleted foverer"):null,r!=null&&r.members?G.createElement(G.Fragment,null,"I understand"," ",G.createElement(g,{style:[i.Bold,i.danger]},r.members," ",G.createElement(be,{count:r.members,singular:"member",plural:"members"}))," ","will be unlinked"):null,"I understand deleted content will not be recoverable"].filter(ot),onDelete:t,onClose:n})}c();var zt=P(k());U();function li(o){let{organization:e}=o,t={type:"organization",organization:e.key};return zt.createElement(l,null,zt.createElement(cn,{pointer:t,style:[s.Margin.largeBottom]}),zt.createElement(To,{owner:{organization:e.key},pointer:t,style:s.Margin.largeBottom}),zt.createElement(mn,{pointer:t}))}c();var Tt=P(k());function ci(o){let{organization:e}=o,t=V(),n=async i=>{if(i===e.title)return;await X(e.key).update({title:i}),t.notify({title:"Organization updated",icon:d.CheckCircle,kind:"success"}),v(I(e,{type:"organization_edit_name"}))};return Tt.createElement(Tt.Fragment,null,Tt.createElement(at,{label:"Display name",labelDescription:"How your organization name will appear to members.",labelSelectable:!0,value:e.title,onChangeText:n}))}function mi(o){let{organization:e}=o;return Ie.createElement(Ie.Fragment,null,Ie.createElement(pe,{title:"General"}),Ie.createElement(D,{title:"Organization profile",style:[s.Margin.largeBottom]},Ie.createElement(ai,{organization:e}),Ie.createElement(ci,{organization:e})),e.hostname?Ie.createElement(D,{title:"Publishing",style:s.Margin.largeBottom},Ie.createElement(li,{organization:e})):null,Ie.createElement(D,{style:[s.Margin.largeBottom,s.Padding.none]},Ie.createElement(si,{organization:e})))}c();var ft=P(k());function ui(o){let{organization:e}=o;return ft.createElement(ft.Fragment,null,ft.createElement(pe,{title:"Apps & Integrations",description:"Apps augment and extend your workflows on GitBook with integrations with other collaboration tools."}),ft.createElement(un,{target:{organization:e.key}}))}c();var ue=P(k());c();var q=P(k());U();function di(o){let{organization:e}=o,[t]=H([Un(e.key)]),[,n]=T(C),[i,r]=se();async function a(m){await r(async()=>{await X(e.key).update({inviteLinksDisabled:!m}),await v(I(e.key,{type:m?"organization_enable_invite_links":"organization_disable_invite_links"}))})}return q.createElement(D,{title:"Invite Links",style:[s.Margin.largeBottom],button:q.createElement(l,{style:[b.directionRow,b.alignCenter]},q.createElement(g,{style:[n.Caption,n.textMuted,s.Margin.smallRight]},"Invite links are ",e.inviteLinksDisabled?"disabled":"enabled"),q.createElement(qe,{disabled:i,value:!e.inviteLinksDisabled,onValueChange:a}))},e.inviteLinksDisabled?q.createElement(g,{style:[n.Label,n.textMuted]},"Invite links are disabled in this organization."):t.length===0?q.createElement(g,{style:[n.Label,n.textMuted]},"There are no invite links in this organization."):t.map(m=>q.createElement(mr,{key:m.key,organization:e.key,invite:m})))}function mr(o){var R,y;let{organization:e,invite:t}=o,n=so(),{getNavigationLinkProps:i}=Ze(),[r,a]=bo([At(t)?Et(t.space):null,Dt(t)?xt(t.collection):null]),m=()=>{v(I(e,{type:"organization_copy_invite_link",role:t.role})),n.writeTextAndNotify(Sn(e,t.key),{title:"Invite link copied",details:"Paste it anywhere to share."})},p=()=>{Vn(e,t.key).delete(),v(I(e,{type:"organization_revoke_link_invite"}))},u=At(t)||Dt(t)?t.contentLevel:t.role,f=u?tn[u]:nn;return q.createElement(ze,{key:t.key,layout:"wide",icon:je(Yt,{icon:f.icon}),title:q.createElement(q.Fragment,null,f.title,At(t)?q.createElement(q.Fragment,null," ","on"," ",q.createElement(wt,B({kind:"blank"},i({screen:{type:"space",space:t.space}})),((R=r==null?void 0:r.result)==null?void 0:R.title)||"Space")):null,Dt(t)?q.createElement(q.Fragment,null," ","on"," ",q.createElement(wt,B({kind:"blank"},i({screen:{type:"collection",collection:t.collection}})),((y=a==null?void 0:a.result)==null?void 0:y.title)||"Collection")):null),hint:q.createElement(q.Fragment,null,"Generated"," ",q.createElement(Le,{value:t.createdAt.toDate(),onlyDate:!1})," \u2E31"," ",Sn(e,t.key)),buttons:[q.createElement(S,{icon:d.Copy,title:"Copy",size:"medium",kind:"secondary",onPress:()=>m()}),q.createElement(S,{icon:d.X,title:"Revoke",size:"medium",kind:"secondary",onPress:()=>p()})]})}c();var Pe=P(k());U();c();var Oe=P(k());function gi(o){let h=o,{user:e,organization:t,member:n}=h,i=Be(h,["user","organization","member"]),r=Fe("FEATURE_DIRECTORY_SYNC"),a=V(),[m,p]=Oe.useState(null),u=(t.samlProviders||r)&&!e.sso,f=Oe.useMemo(()=>Qe({groups:[...u?[{key:"sso",commands:[{icon:d.ArrowRight,key:"sso.enable",title:"Link to SSO",trigger:()=>p("sso")}]}]:[],{key:"memberDanger",commands:[{key:"memberDanger.remove",title:"Remove",icon:d.Trashcan,trigger:()=>p("delete")}]}].filter(Boolean)}),[t,n,e]),R=async z=>{p(null),z&&(await Lt(n.organization,e.uid).delete(),v(I(n.organization,{type:"organization_remove_member",role:n.role,removedUser:e.uid})),a.notify({title:`${e.displayName} removed`,details:"They will no longer be able to access any private content.",kind:"default",icon:d.User}))},y=async z=>{p(null),z&&(a.notifyProgress(ur(n),{title:`Enabling SSO for "${e.displayName}"\u2026`,details:"This might take a moment.",kind:"default"}),v(I(n.organization,{type:"organization_link_sso_member"})))};return Oe.createElement(Oe.Fragment,null,Oe.createElement(Ke,B({palette:f,icon:d.MoreVertical,size:"medium"},i)),m==="delete"?Oe.createElement(j,{kind:"danger",title:`Remove "${e.displayName}" from this organization`,confirmButtonText:"Delete",onComplete:R},"If you remove this member, they will no longer have access to the content."):null,m==="sso"?Oe.createElement(j,{kind:"primary",title:`Link "${e.displayName}" to SSO login`,confirmButtonText:"Activate",onComplete:y},'The user will be able to login using your SAML SSO with the email "',e.email,'". They will also be synced with your directory, if enabled.'):null)}async function ur(o){await(await Ne()).organizations.setUserAsSsoMemberForOrganization(o.organization,o.user)}c();var pi=P(k());function fi(o){let r=o,{member:e}=r,t=Be(r,["member"]),n=V(),i=async a=>{let m=new En("updateMemberRole",{sampleRate:1});m.label("Organization",e.organization),m.label("User",e.user),m.label("Role",a),await m.wrap(async()=>Lt(e.organization,e.user).update({role:a})),n.notify({title:"Role updated",details:`User now has ${a||"guest"} permissions`,icon:d.User,kind:"default"}),v(I(e.organization,{type:"organization_edit_member",previousRole:e.role,role:a}))};return pi.createElement(mt,B({mode:"member",organization:e.organization,value:e.role,onValueChange:i},t))}c();var yt=P(k());function yi(o){let a=o,{member:e,teams:t}=a,n=Be(a,["member","teams"]);if(t.length===0)return null;let i=t.filter(m=>m.members.includes(e.user)),r=i.length>0?yt.createElement(yt.Fragment,null,i.length," ",yt.createElement(be,{count:i.length,singular:"team",plural:"teams"})):"No team";return yt.createElement(Ke,B({size:"small",rightIcon:d.ChevronDown,palette:()=>bi(e)},n),r)}function bi(o){return Qe({search:"Select teams\u2026",groups:[{key:"teams",title:"Teams",commands:()=>{let e=_t(o.organization),[t]=lt([e]);return t.map(n=>{let i=n.members.includes(o.user);return{key:n.key,title:n.title,icon:d.Users,checked:i,trigger:()=>(nt(r=>{i?Vt(r,o.organization,n.key,[o.user]):Ut(r,o.organization,n.key,[o.user])}),v(I(o.organization,{type:i?"team_remove_member":"team_add_member",team:n.key})),Xt.clear(e),bi(o))}})}}]})}function hi(o){let{organization:e,teams:t}=o,n=(i,r)=>Pe.createElement(Me,{data:i,renderItem:({item:m})=>Pe.createElement(dr,te(B({},m),{organization:e,teams:t,query:r})),keyExtractor:gr});return Pe.createElement(ko,{organization:e.key},n)}function dr(o){let{user:e,organization:t,member:n,teams:i,query:r}=o,a=Ae(),m=!n.dsync&&!(n.role==="admin"&&a.uid===e.uid),p=Wt(en,{squared:!1,user:e},[e]);return Pe.createElement(ze,{layout:"wide",icon:p,title:Pe.createElement($t,{selectable:!0,text:e.displayName,query:r}),hint:Pe.createElement(g,{selectable:!0},e.email?`${e.email} \u2E31 j`:"J","oined"," ",Pe.createElement(Le,{value:n.joinedAt.toDate(),onlyDate:!1})),buttons:[n.dsync?Pe.createElement(Rt,null,"Directory"):null,e.sso===t.key?Pe.createElement(Rt,null,"SSO"):null,Pe.createElement(yi,{member:n,teams:i,disabled:!m,kind:"secondary",size:"medium"}),Pe.createElement(fi,{member:n,disabled:!m,kind:"secondary",size:"medium"}),m?Pe.createElement(gi,{organization:t,user:e,member:n,kind:"secondary",size:"medium"}):null]})}function gr(o){return o.user.uid}c();var x=P(k());U();function Si(o){let{organization:e,teams:t}=o,[n,i]=x.useState(""),[r,a]=x.useState(null),m=ct({organization:e.key},"teams"),p=()=>{a(null)};return x.createElement(x.Fragment,null,x.createElement(l,{style:[b.directionRow,b.alignCenter,s.Margin.mediumBottom]},x.createElement(l,{style:[b.flex1,s.Margin.mediumRight]},x.createElement(N,{size:"medium",kind:"search",cleareable:!0,value:n,onChangeText:i,placeholder:"Search by name",icon:d.Search})),x.createElement(it,{upgrade:m,kind:"secondary",icon:d.Plus,onPress:()=>a("creating"),size:"medium",upgradeTitle:"Upgrade your plan to access teams!"},"New team")),x.createElement(pr,{organization:e,teams:t,query:n,upgrade:m,onCreateTeam:()=>a("creating")}),x.createElement(J,null,r==="creating"?x.createElement(Vo,{org:e.key,onCreate:p,onClose:p}):null))}function pr(o){let{teams:e,organization:t,query:n,upgrade:i,onCreateTeam:r}=o,[,a]=T(C),m=x.useCallback(({item:u})=>x.createElement(fr,{team:u,query:n,organization:t}),[t,n]),p=x.useMemo(()=>n?new jn(e,{shouldSort:!0,threshold:.4,distance:100,keys:[{name:"title",weight:1}]}).search(n).map(f=>f.item):e,[n,e]);return e.length===0?x.createElement(Ve,{kind:i?"primary":"default",icon:d.EmptyTeam,action:x.createElement(it,{upgrade:i,icon:d.Plus,kind:"secondary",size:"large",onPress:r},"Create a new team")},i?x.createElement(x.Fragment,null,"Teams let you manage entire departments at once, by bundling members together into groups."," ",x.createElement(g,{style:a.Bold},"Upgrade your plan to access teams.")):x.createElement(x.Fragment,null,"Teams let you manage entire departments at once, by bundling members together into groups.")):p.length===0?x.createElement(Ve,null,"No results matching"):x.createElement(l,null,x.createElement(Me,{data:p,renderItem:m}))}function fr(o){let{team:e,organization:t,query:n}=o,i=Wt(Co,{team:e},[e]);return x.createElement(ze,{layout:"wide",title:x.createElement($t,{query:n,text:e.title,selectable:!0}),icon:i,hint:x.createElement(g,{selectable:!0},"Created ",x.createElement(Le,{value:e.createdAt.toDate(),onlyDate:!1})),buttons:[...e.dsync?[x.createElement(Rt,null,"Directory")]:[],x.createElement(Go,{orgKey:t.key,team:e,kind:"secondary",size:"medium"}),x.createElement(Fo,{orgKey:t.key,team:e,icon:d.MoreVertical,kind:"secondary",size:"medium",isDirectoryTeam:!!e.dsync})]})}function Ri(o){let{organization:e}=o,{getNavigationLinkProps:t}=Ze(),[n,i]=ue.useState("members"),[r,a]=H([_t(e.key),Mt(e.key)]);return ue.createElement(ue.Fragment,null,ue.createElement(pe,{title:"Members & permissions",description:"Manage permissions and invite people and teams."}),ue.createElement(D,{titleTabs:ue.createElement(ue.Fragment,null,ue.createElement(st.Tab,{active:n==="members",badge:(a==null?void 0:a.members)||1,onPress:()=>i("members")},"Members"),ue.createElement(st.Tab,{active:n==="teams",badge:r.length,onPress:()=>i("teams")},"Teams")),button:ue.createElement(S,B({testID:"settings.members.inviteButton",kind:"primary",icon:d.Plus,size:"medium"},t({overlay:{type:"org_invite",organization:e.key}})),"Invite new members"),style:[s.Margin.largeBottom]},n==="members"?ue.createElement(hi,{organization:e,teams:r}):null,n==="teams"?ue.createElement(Si,{organization:e,teams:r}):null),ue.createElement(di,{organization:e}))}c();var he=P(k());U();c();var Pi=P(Gi()),Ye=P(k());U();function wi(o){let{organization:e,billing:t,style:n}=o,[,i]=T(C),r=fo(e,t);if(r==="community")return Ye.createElement(Te,{kind:"default",icon:je(io,{code:"2764"}),title:"Community plan",details:"GitBook is happy to support your organization, enjoy it for free!",style:n,actions:[{label:"Share your love on Twitter!",onPress:()=>{let a=`http://twitter.com/home?${Pi.default.stringify({status:"Thank you @GitBookIO \u{1F64C} for hosting our #docs ! https://www.gitbook.com"})}`;lo(a)}}]});if(r===null)return Ye.createElement(Te,{kind:"default",icon:d.Premium,title:"Your organization has been disabled",details:Ye.createElement(g,{selectable:!0},'Please update your billing information to set up a new subscription and unlock your account."'),style:n});if(t.status==="trialing"&&t.trialEnd){let a=Math.floor((t.trialEnd.toDate().getTime()-Date.now())/864e5);return Ye.createElement(Te,{kind:"soft-info",icon:d.Premium,title:"Free trial",details:Ye.createElement(g,{selectable:!0},"Your free trial will end"," ",Ye.createElement(g,{style:[i.Bold]},a===0?"today":a===1?"tomorrow":`in ${a} days`),". After your free trial ends on"," ",Ye.createElement(g,{style:[i.Bold]},Ye.createElement(no,{value:t.trialEnd.toDate()})),", this plan will no longer be available. You can upgrade your plan at any time."),style:n})}return null}c();var w=P(k());U();c();c();var zi="https://js.stripe.com/v3",yr=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ki="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",br=function(){for(var e=document.querySelectorAll('script[src^="'.concat(zi,'"]')),t=0;t<e.length;t++){var n=e[t];if(!!yr.test(n.src))return n}return null},hr=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(zi).concat(t);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(n),n},Sr=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"1.13.1",startTime:t})},yn=null,Rr=function(e){return yn!==null||(yn=new Promise(function(t,n){if(typeof window>"u"){t(null);return}if(window.Stripe&&e&&console.warn(ki),window.Stripe){t(window.Stripe);return}try{var i=br();i&&e?console.warn(ki):i||(i=hr(e)),i.addEventListener("load",function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))}),i.addEventListener("error",function(){n(new Error("Failed to load Stripe.js"))})}catch(r){n(r);return}})),yn},Pr=function(e,t,n){if(e===null)return null;var i=e.apply(void 0,t);return Sr(i,n),i},Ti=Promise.resolve().then(function(){return Rr(null)}),Ci=!1;Ti.catch(function(o){Ci||console.warn(o)});var vi=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Ci=!0;var i=Date.now();return Ti.then(function(r){return Pr(r,t,i)})};var De=P(k());var wr=oo(async o=>{let e=await vi(o);if(!e)throw new Error("Failed to load Stripe. It cannot be loaded in a server environment");return e});function Ii(o){var O,ke;let{organization:e,billing:t,product:n,interval:i,reason:r}=o,a=V(),[m,p]=se(),[u,f]=De.useState(null),R=wr.read(_e.stripe.public_key);if(t.status==="active"&&n===t.product&&(t.interval===i||n==="free"))return De.createElement(S,{kind:"secondary",icon:d.CheckCircle,size:"medium",disabled:!0,testID:"settings.disabledButton"},"Current plan");let y=kr(t,n,i),h=()=>{f(y==="downgrade"?"downgrade":"upgrade")},z=()=>{p(async()=>{let de=await Ne();try{let{data:Ct}=await de.organizations.upgradeOrganizationPlan(e.key,{product:n,interval:i,reason:r});Ct.sessionId?await R.redirectToCheckout({sessionId:Ct.sessionId}):a.notify({kind:"success",title:"Success!",details:"Your plan change was successful"})}catch(Ct){a.notify({kind:"danger",title:"Error",icon:d.Alert,details:Ot(Ct,"An unexpected error occurred, please contact support!")})}})},A=de=>{f(null),de&&z()};return De.createElement(De.Fragment,null,u==="downgrade"?De.createElement(j,{kind:"danger",title:"Are you sure you want to downgrade?",confirmButtonText:"Downgrade",onComplete:A,testID:"settings.downgradeModal"},"Your account will be switched to the"," ",(O=Je.find(de=>de.key===n))==null?void 0:O.title," plan. Some features may become unavailable. A credit for the difference will be applied to your account."):null,u==="upgrade"?De.createElement(j,{kind:"upgrade",title:"Are you sure you want to upgrade?",confirmButtonText:"Upgrade",onComplete:A,testID:"settings.upgradeModal"},"Your account will be switched to the"," ",(ke=Je.find(de=>de.key===n))==null?void 0:ke.title," plan."," ",t.status==="incomplete_expired"||t.status==="trialing"||t.status==="canceled"||n==="free"?"":"Your card will immediately be charged a prorated amount for the upgrade."):null,De.createElement(S,te(B(B({},zr(y)),m?{icon:rt,disabled:!0}:{}),{size:"medium",onPress:h,testID:"settings.upgradeButton"})))}function kr(o,e,t){let n=Je.findIndex(r=>r.key===o.product),i=Je.findIndex(r=>r.key===e);return i>n?"upgrade":i<n?o.status!=="active"?"upgrade_passive":"downgrade":i===n&&o.status!=="active"?"upgrade":o.interval==="monthly"&&t==="yearly"?"switch_to_yearly":"switch_to_monthly"}function zr(o){switch(o){case"upgrade":return{kind:"upgrade",children:"Upgrade"};case"upgrade_passive":return{kind:"secondary",children:"Upgrade"};case"downgrade":return{kind:"secondary",children:"Downgrade"};case"switch_to_yearly":return{kind:"secondary",children:"Change to yearly"};case"switch_to_monthly":return{kind:"secondary",children:"Change to monthly"};default:Ue(o)}}c();var Bn=P(k());function Oi(o){let{organization:e}=o,t=Jt();return e.type==="community"?Bn.createElement(S,{kind:"secondary",icon:d.CheckCircle,size:"medium",disabled:!0},"Current plan"):Bn.createElement(S,{kind:"secondary",size:"medium",onPress:()=>{t()}},"Contact us")}c();var Mn=P(k());function Bi(o){let{organization:e,billing:t}=o,n=Ae();if(e.type==="legacy-enterprise"||t.product==="enterprise")return Mn.createElement(S,{kind:"secondary",icon:d.CheckCircle,size:"medium",disabled:!0},"Current plan");let r=new URL("https://www.gitbook.com/contact/contact-sales");return r.searchParams.set("org.id",e.key),r.searchParams.set("user.id",n.uid),n.email&&r.searchParams.set("user.email",n.email),Mn.createElement(S,{kind:"secondary",size:"medium",href:r.toString()},"Contact us")}function xi(o){let{organization:e,billing:t,highlightedFeature:n}=o,i=Fe("UPGRADE_DEFAULT_CYCLE"),a=Fe("FEATURE_COMMUNITY_PLAN")||e.type==="community",[m,p]=Ht(t.interval==="monthly"&&t.status!=="trialing"?!1:i==="yearly",[t.interval,t.status]),[,u]=T(C),[,f]=T(Ei),R=a?Je:Je.filter(h=>h.key!=="community"),y=[f.column,{width:`${100/(R.length+1)}%`}];return w.createElement(l,{style:f.body},w.createElement(l,{style:[f.stickyHeader,s.Padding.largeBottom]},w.createElement(l,{style:[f.switchHeader,b.directionColumn,b.alignCenter,s.Padding.medium]},w.createElement(qe,{label:"Pay yearly (20% discount)",value:m,onValueChange:p,style:s.Padding.smallHorizontal})),w.createElement(l,{style:[b.directionRow,s.Padding.largeTop]},w.createElement(l,{style:y},w.createElement(l,null)),R.map(h=>w.createElement(l,{key:h.key,style:[y,s.Padding.mediumHorizontal]},w.createElement(l,null,w.createElement(g,{style:[u.Heading2,u.text,u.AlignCenter]},h.title))))),w.createElement(l,{style:[b.directionRow,b.alignCenter,s.Margin.mediumVertical]},w.createElement(l,{style:y},w.createElement(l,null)),R.map(h=>w.createElement(l,{key:h.key,style:y},h.pricing?w.createElement(l,{style:[b.directionColumn,b.alignCenter]},w.createElement(l,null,w.createElement(g,{selectable:!0,style:[u.Heading1,u.primary]},w.createElement(g,{style:[u.Body]},"$ "),Cr(m?h.pricing.perUserPerYear:h.pricing.perUserPerMonth))),w.createElement(l,{style:[s.Padding.xsmallTop]},w.createElement(g,{selectable:!0,style:[u.Label,u.textMuted,u.AlignCenter]},"Per User Per Month"),h.minUsers?w.createElement(g,{selectable:!0,style:[u.Label,u.textMuted,u.AlignCenter]},"Starting At"," ",w.createElement(g,{style:[u.Bold,u.textMid]},h.minUsers)," ","Users"):null)):w.createElement(l,{style:[b.directionColumn,b.alignCenter]},w.createElement(l,null,w.createElement(g,{style:[u.Heading2,u.primary,s.Padding.smallTop,s.Padding.xsmallBottom]},"Custom")),w.createElement(l,null,w.createElement(g,{selectable:!0,style:[u.Label,u.textMuted,u.AlignCenter]},"Custom Pricing"),w.createElement(g,{selectable:!0,style:[u.Label,u.textMuted,u.AlignCenter]},"Tailored to Your Needs")))))),w.createElement(l,{style:[b.directionRow,b.alignEnd]},w.createElement(l,{style:y},w.createElement(l,null)),R.map(h=>w.createElement(l,{key:h.key,style:y},w.createElement(l,{style:[s.Padding.mediumHorizontal]},h.pricing&&Ir(h.key)?w.createElement(Ii,{organization:e,billing:t,product:h.key,interval:m?"yearly":"monthly",reason:n}):null,h.key==="enterprise"?w.createElement(Bi,{organization:e,billing:t}):null,h.key==="community"?w.createElement(Oi,{organization:e}):null))))),w.createElement(l,null,Rn.map((h,z)=>{let A=Pn.filter(O=>O.category===h.key);return w.createElement(l,{key:h.key,style:[s.Margin.largeTop]},w.createElement(l,{style:[s.Padding.small,s.Padding.largeHorizontal]},w.createElement(g,{selectable:!0,style:[u.Heading3,u.text]},h.title)),w.createElement(l,null,A.map((O,ke)=>w.createElement(Tr,{key:O.key,feature:O,columnStyle:y,products:R,highlighted:n===O.key,last:z===Rn.length-1&&ke===Pn.length-1}))))})))}function Tr(o){let{feature:e,last:t,highlighted:n,products:i,columnStyle:r}=o,[,a]=T(C),[,m]=T(Ei);return w.createElement(l,{nativeID:e.key,style:[b.directionRow,b.alignStretch,s.Padding.mediumHorizontal,n?m.rowHighlighted:t?null:m.rowBorder]},w.createElement(l,{style:[r]},w.createElement(l,{style:m.columnWithBorder},w.createElement(g,{selectable:!0,style:[a.Body,a.text]},e.title))),i.map(p=>w.createElement(l,{key:p.key,style:[r]},w.createElement(l,{style:[m.columnWithBorder,b.alignCenter]},w.createElement(vr,{featureKey:e.key,value:e[p.key]})))))}var Mi={customization:{true:"Enhanced",false:"Basic"}};function Cr(o){return o%1===0?`${o}`:o.toFixed(2)}function vr(o){let{value:e,featureKey:t}=o,[,n]=T(C);return Mi[t]?w.createElement(g,{selectable:!0,style:[n.Body,e?n.primary:n.textMuted]},Mi[t][`${e}`]):e===!0?w.createElement(d.Check,{size:ae.ICON_M,style:n.primary}):e===!1?w.createElement(d.X,{size:ae.ICON_S,style:n.textMuted}):e===1/0?w.createElement(g,{selectable:!0,style:[n.Body,n.text]},"Unlimited"):e===0?w.createElement(g,{selectable:!0,style:[n.Body,n.textMuted]},"None"):w.createElement(g,{selectable:!0,style:[n.Body,n.text]},e)}var Ei=Gt.create({body:o=>({backgroundColor:o.colors.background.main,borderRadius:ae.RADIUS_XL,borderWidth:1,borderColor:o.colors.border.mid}),switchHeader:o=>({borderBottomColor:o.colors.border.mid,borderBottomWidth:1}),rowBorder:o=>({borderBottomWidth:1,borderBottomColor:o.colors.border.mid,paddingVertical:s.small}),rowHighlighted:o=>te(B({},o.shadows.base),{borderWidth:1,borderColor:o.colors.primary.main,paddingVertical:s.small}),column:o=>({paddingHorizontal:s.small,paddingVertical:s.small}),columnWithBorder:o=>({flex:1,justifyContent:"center"}),stickyHeader:o=>B({position:"sticky",top:0,zIndex:10,backgroundColor:o.colors.background.main,borderTopRightRadius:ae.RADIUS_XL,borderTopLeftRadius:ae.RADIUS_XL},o.shadows.tight)});function Ir(o){return o!=="community"&&o!=="enterprise"&&o!=="startup"&&o!=="legacy"}function Li(o){let{organization:e,highlightedFeature:t}=o,n=Jt(),[i]=H([Fn(e.key)]);return he.createElement(l,null,he.createElement(pe,{title:"Plans",description:"Start big or small and scale as you grow - free forever for individuals, open-source teams and no-profit organizations."}),e.type==="legacy-enterprise"?he.createElement(l,null,he.createElement(Te,{kind:"info",icon:d.HelpCircle,title:"Enterprise subscription",details:"You are currently on an enterprise plan. Contact your support manager for more info.",actions:[{label:"Contact support",onPress:()=>n()}]})):he.createElement(he.Fragment,null,i?he.createElement(he.Fragment,null,he.createElement(wi,{organization:e,billing:i,style:[s.Margin.largeBottom]}),he.createElement(l,null,he.createElement(xi,{organization:e,billing:i,highlightedFeature:t}))):he.createElement(Y,{size:"large"})))}c();var tt=P(k());c();var Q=P(k());U();c();var K=P(k());U();function Ai(o){let{organization:e,onComplete:t}=o,[n,i]=K.useState([]),[r,a]=se(!1),m=V(),p=f=>{i(R=>R.includes(f.id)?R.filter(y=>y!==f.id):R.concat(f.id))};async function u(f){if(!f){t();return}await a(async()=>{await(await Ne()).organizations.syncDirectorySyncGroupsToTeams(e.key,{to_sync:n.map(y=>({group_id:y}))}),m.notify({kind:"default",title:"Groups successfully synchronized...",details:"We'll start adding members to the newly synchronized teams..."})}),t()}return K.createElement(j,{kind:"primary",title:"Sync your directory groups",confirmButtonText:"Confirm",onComplete:u},K.createElement(Or,{loading:r,organization:e,selectedGroups:n,onSelectGroup:p}))}function Or(o){let{loading:e,organization:t,selectedGroups:n,onSelectGroup:i}=o,[,r]=T(C),[a,m]=K.useState(null),p=async f=>{let R=await Ne(),{data:y}=await R.organizations.listDirectorySyncGroups(f);m(y)};if(K.useEffect(()=>{p(t.key)},[t.key]),!a)return K.createElement(l,null,K.createElement(g,{style:r.Body},"We're fetching the groups from your directory..."),K.createElement(Y,{size:"medium"}));let{groups:u}=a;return u.length===0?K.createElement(g,{style:r.Body},"We didn't find any groups in your directory. Ensure that any groups you wish to sync to GitBook are exposed in your Identity Provider."):K.createElement(l,null,K.createElement(l,{style:s.Margin.mediumBottom},K.createElement(g,{style:r.Body},"We found the following groups in your directory. Select the groups you wish to sync with GitBook.")),K.createElement(Me,{data:u,renderItem:({item:f})=>K.createElement(Br,{group:f,selected:n.includes(f.id),onSelect:i,loading:e})}))}function Br(o){let{loading:e,group:t,selected:n,onSelect:i}=o,[,r]=T(C);return K.createElement(ze,{layout:"wide",title:K.createElement(g,{style:r.Body},t.name),buttons:t.teamKey?[K.createElement(g,{style:(r.Label,r.textMuted)},"Aready synced")]:[K.createElement(Zn,{value:n,onValueChange:()=>i(t),readOnly:e})]})}function Di(o){let{organization:e,sso:t}=o,[,n]=T(C),[i,r]=Q.useState(null),a=V();async function m(){let u=await Ne(),{data:f}=await a.notifyProgress(u.organizations.setupDirectorySync(e.key),{kind:"default",title:"Preparing the setup process...",details:"You'll be redirected to the setup flow shortly ...",timeout:0});f.setupUrl&&(window.location.href=f.setupUrl)}async function p(u){u&&(await sn(e.key).update({dsync:xe.firestore.FieldValue.delete()}),a.notify({kind:"default",title:"Directory Sync successfully removed",icon:d.CloudOff,details:"We'll deprovision directory users from your organization, this may take a few minutes.",timeout:8e3})),r(null)}return Q.createElement(Q.Fragment,null,i==="remove"?Q.createElement(j,{kind:"danger",title:"Remove Directory Sync",confirmButtonText:"Remove",onComplete:p},"Removing directory sync will remove all users associated with this directory from your GitBook organization. You'll need to go through the setup process again to reprovision these users."):null,i==="teams"?Q.createElement(Ai,{organization:e,onComplete:()=>r(null)}):null,Q.createElement(D,{title:"Directory Sync",style:[s.Margin.largeBottom],button:t!=null&&t.dsync?Q.createElement(S,{kind:"primary",icon:d.Plus,size:"medium",onPress:()=>{r("remove")}},"Remove Directory Sync"):Q.createElement(S,{kind:"primary",icon:d.Plus,size:"medium",onPress:m},"Setup Directory Sync")},Q.createElement(l,null,Q.createElement(g,{style:[n.Label,n.textMid]},t!=null&&t.dsync?null:Q.createElement(l,null,Q.createElement(g,null,"Directory Sync will keep your enterprise directory synced with GitBook. All users in your directory will be created as users in GitBook, and added to this organization. Removing users from your directory will remove them from GitBook."),Q.createElement(g,{style:s.Margin.smallTop},"Directory Sync is an advanced feature that helps you use GitBook at scale."," ",Q.createElement(Xe,{path:"/"},"Learn more here."))),t!=null&&t.dsync?Q.createElement(l,null,Q.createElement(g,null,"Directory Sync with"," ",Q.createElement(g,{style:n.Bold},t.dsync.name)," is enabled and synced with GitBook!"),Q.createElement(g,{style:s.Margin.smallTop},"Users who are added/removed to your directory will be automatically added/removed to your GitBook organization."),Q.createElement(g,{style:s.Margin.smallTop},"You can also configure your directory groups to be synced with your GitBook teams."," ",Q.createElement(wt,{onPress:()=>r("teams")},"Configure your teams here."))):null))))}c();var bt=P(k());function _i(o){let{organization:e}=o,[t,n,{reset:i}]=eo({initialState:e.emailDomains}),r=V(),[a,m]=se(),p=ct({organization:e.key},"email-domain"),u=!Mr(n,e.emailDomains),f=()=>{i(),u&&m(async()=>{await X(e.key).update({emailDomains:n.filter(h=>Hn(h))}),r.notify({title:"Email domain SSO updated",details:"Anyone with a matching email address will be able to join your organization.",icon:d.CheckCircle,kind:"default"}),v(I(e,{type:"organization_edit_email_domains"}))})},R=y=>{v(I(e,{type:"organization_set_default_role",role:y})),X(e.key).update({defaultRole:y}),r.notify({title:"Default role updated",details:"Anyone with a matching email address will join with this role.",icon:d.CheckCircle,kind:"default"})};return bt.createElement(D,{title:"Email domains",style:[s.Margin.largeBottom]},bt.createElement(to,te(B({label:"Allowed email domains",labelDescription:"Anyone with an email address matching these domains can access this organization when they sign in.",labelSelectable:!0,placeholder:"e.g. mycompany.com"},t),{button:u||a?bt.createElement(it,{disabled:a,upgrade:p,size:"small",kind:"primary",icon:a?rt:void 0,onPress:f,upgradeTitle:"Upgrade your plan to enable SSO!"},"Save"):null})),bt.createElement(ne,{label:"Default role",labelDescription:"Role initially set on new members joining using an allowed email domain.",style:s.Margin.largeTop},bt.createElement(mt,{kind:"secondary",size:"medium",organization:e.key,mode:"member",value:e.defaultRole||null,allowNullValue:!0,onValueChange:R})))}function Mr(o,e){return o.length===e.length&&!o.some(t=>!e.includes(t))}c();var _=P(k());U();c();var L=P(k());U();function Ui(o){let{provider:e,organization:t,onClose:n}=o;return L.createElement(kt,{opened:!!e,onClose:n,title:"Register SAML2 Identity Provider"},e?L.createElement(kt.PanelGroup,null,L.createElement(xr,{organization:t,provider:e,onClose:n}),L.createElement(Er,{organization:t,provider:e})):null)}function xr(o){let{organization:e,onClose:t}=o,[n,i]=Ht(o.provider,[o.provider]),[r,a]=L.useState(null),[m,p]=L.useState(!1),[u]=H([an(e.key,n.key)]),[,f]=T(C);le(I(e,{screen:"organization_settings_saml",screenTab:u?"edit":"create"}),[e.key,!!u]);let R=()=>{let z=!u;v(I(e,{type:z?"organization_create_saml":"organization_edit_saml"})),nt(A=>{Bo(A,e.key,n)}),z?p(!0):t()},y=()=>{a("delete")},h=z=>{a(null),z&&(v(I(e,{type:"organization_delete_saml"})),nt(A=>{Mo(A,e,n.key)}),t())};return L.createElement(L.Fragment,null,L.createElement(kt.Panel,{text:"Configure"},L.createElement(l,{style:s.Margin.largeBottom},L.createElement(g,{style:[f.Body,f.text]},"Provide your individual Identity Provider metadata fields.")),m?L.createElement(l,{style:[s.Margin.largeBottom]},L.createElement(Te,{icon:d.Check,kind:"success",details:"SAML2 Identity provider has been correctly configured on GitBook. Copy the service informations to your configure GitBook as a service on your identity provider side."})):null,L.createElement(N,{label:"Label",labelDescription:"Label to represent this identity provider during sign-in.",value:n.label,onChangeText:z=>i(te(B({},n),{label:z})),style:s.Margin.largeBottom}),L.createElement(N,{label:"Entity ID",value:n.entityID,onChangeText:z=>i(te(B({},n),{entityID:z})),style:s.Margin.largeBottom}),L.createElement(N,{label:"Single Sign On URL",value:n.ssoURL,onChangeText:z=>i(te(B({},n),{ssoURL:z})),style:s.Margin.largeBottom}),L.createElement(N,{label:"x509 public certificate",value:n.certificate,onChangeText:z=>i(te(B({},n),{certificate:z})),numberOfLines:4,multiline:!0,style:s.Margin.largeBottom}),L.createElement(ne,{label:"Default role",labelDescription:"Role assigned to users on first sign-in, it can be edited per user later in the teams settings."},L.createElement(mt,{organization:e.key,mode:"member",value:n.defaultRole,allowNullValue:!0,onValueChange:z=>{i(te(B({},n),{defaultRole:z}))},kind:"secondary"})),L.createElement(l,{style:[b.directionRow,s.Margin.largeTop]},L.createElement(S,{kind:"primary",onPress:R},"Save"),u?L.createElement(S,{icon:d.Trashcan,style:[s.Margin.smallLeft],onPress:y},"Delete"):null)),r==="delete"?L.createElement(j,{kind:"danger",title:"Do you want to delete this SAML provider ?",confirmButtonText:"Delete",onComplete:h},"Deleting this SAML2 identity provider will prevent people from signin, but will not remove accounts from your organization."):null)}function Er(o){let{organization:e,provider:t}=o,[,n]=T(C),i=t.key===e.deprecatedDefaultSAMLProvider?"":`/provider/${t.key}`,r=`https://${_e.firebase.authDomain}/saml/${e.key}${i}`;return L.createElement(kt.Panel,{text:"Service informations"},L.createElement(l,{style:s.Margin.largeBottom},L.createElement(g,{style:[n.Body,n.text]},"Copy the following informations to your configure GitBook as a service in your SSO provider.")),L.createElement(N,{label:"Start URL",value:`${r}/login`,readOnly:!0,copyable:!0,style:s.Margin.largeBottom}),L.createElement(N,{label:"ACS URL",value:`${r}/assert`,readOnly:!0,copyable:!0,style:s.Margin.largeBottom}),L.createElement(N,{label:"Entity ID",value:`${r}/metadata.xml`,readOnly:!0,copyable:!0,style:s.Margin.largeBottom}),L.createElement(N,{label:"Name-ID format",value:"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress",readOnly:!0,copyable:!0,style:s.Margin.largeBottom}),L.createElement(N,{label:"Sign In URL",value:_n({type:"root",organization:e.key}),readOnly:!0,copyable:!0}))}function Vi(o){let{organization:e}=o,[t,n]=_.useState(void 0),i=ct({organization:e.key},"sso"),r=()=>{if(i)return i();n(xo())};return _.createElement(_.Fragment,null,_.createElement(D,{title:"SAML",style:[s.Margin.largeBottom]},_.createElement(_.Suspense,{fallback:_.createElement(Y,{size:"medium"})},_.createElement(Lr,{organization:e,open:n,upgrade:i,onCreate:r}))),_.createElement(Ui,{organization:e,provider:t,onClose:()=>n(void 0)}))}function Lr(o){let{organization:e,open:t,upgrade:n,onCreate:i}=o,[,r]=T(C),[a]=H([zn(e.key)]),m=_.useCallback(({item:u})=>_.createElement(Ar,{provider:u,onOpen:()=>t(u)}),[t]),p=n?_.createElement(_.Fragment,null,"Authenticate securely to GitBook with an SAML2 Identity Provider."," ",_.createElement(g,{style:r.Bold},"Upgrade your plan to access SAML.")):_.createElement(_.Fragment,null,"Authenticate securely to GitBook with an SAML2 Identity Provider.");return a.length===0?_.createElement(Ve,{icon:d.EmptySSO,kind:n?"primary":"default",action:_.createElement(it,{upgrade:n,icon:d.Plus,kind:"secondary",size:"large",upgradeTitle:"Upgrade your plan to enable SAML!",onPress:i},"Register identity provider")},_.createElement(g,{selectable:!0},p)):_.createElement(l,null,_.createElement(l,{style:s.Margin.mediumBottom},_.createElement(g,{selectable:!0,style:[r.Body,r.textMuted]},p)),_.createElement(Me,{data:a,renderItem:m}))}function Ar(o){let{provider:e,onOpen:t}=o,n=e.defaultRole?tn[e.defaultRole]:nn;return _.createElement(ze,{layout:"wide",title:_.createElement(g,{selectable:!0},"provider.label"),icon:je(Yt,{icon:n.icon}),hint:_.createElement(g,{selectable:!0},e.ssoURL," \u2E31 ",n.title," \u2E31 Created"," ",_.createElement(Le,{value:e.createdAt.toDate(),onlyDate:!1})),buttons:[_.createElement(S,{title:"Edit",icon:d.MoreVertical,onPress:t})]})}function Ni(o){let{organization:e}=o,t=Fe("FEATURE_DIRECTORY_SYNC"),[n]=H([sn(e.key)]);return tt.createElement(tt.Fragment,null,tt.createElement(pe,{title:"SSO & SAML",description:"Configure email domain SSO or a third-party SAML provider."}),tt.createElement(_i,{organization:e}),tt.createElement(Vi,{organization:e}),t||(n==null?void 0:n.dsync)?tt.createElement(Di,{organization:e,sso:n}):null)}function Fi(o){let{screen:e}=o,[t]=H([X(e.organization)]),n=Ae(),i=Ro(t?{organization:t==null?void 0:t.key}:{user:n.uid});return!$n(i,"admin-profile")||!t?we.createElement(Kt,{to:{screen:{type:"account",tab:"profile"}}}):we.createElement(Dr,{screen:e,organization:t})}function Dr(o){let{screen:e,organization:t}=o;return jt(n=>{n.setTitle(t?t.title:"Not found")}),le(t?I(t,_r(e)):null,[e.organization,e.tab]),t?we.createElement(we.Fragment,null,e.tab==="profile"?we.createElement(mi,{organization:t}):null,e.tab==="members"?we.createElement(Ri,{organization:t}):null,e.tab==="billing"?we.createElement(ri,{organization:t}):null,e.tab==="sso"?we.createElement(Ni,{organization:t}):null,e.tab==="plans"?we.createElement(Li,{organization:t,highlightedFeature:e.hash}):null,e.tab==="integrations"?we.createElement(ui,{organization:t}):null):we.createElement(Y,{size:"large"})}function _r(o){switch(o.tab){case"billing":return{screen:"organization_settings_billing"};case"members":return{screen:"organization_settings_members"};case"plans":return{screen:"organization_settings_plans",reason:o.hash};case"profile":return{screen:"organization_settings_profile"};case"sso":return{screen:"organization_settings_sso"};case"integrations":return{screen:"organization_settings_integrations"};default:Ue(o.tab)}}function Ur(o){let{screen:e}=o,[t]=T();return $e.createElement(Kn,{component:xn,backgroundColor:t.colors.background.main,style:[b.flex1],contentContainerStyle:[b.flexGrow1,b.directionRow,b.justifyContentCenter,s.Padding.xlargeVertical,s.Padding.largeHorizontal]},$e.createElement(l,{style:[b.flex1,Vr.body]},$e.createElement($e.Suspense,{fallback:$e.createElement(Y,{size:"xlarge"})},e.type==="account"?$e.createElement(ii,{screen:e}):null,e.type==="org_settings"?$e.createElement(Fi,{screen:e}):null)))}var Vr=vt.create({body:{maxWidth:900}});export{Ur as default};
//# sourceMappingURL=https://app.gitbook.com/public/app/chunks/SettingsScreen.lazycomponent-JPE26R5J.min.js.map
